{"openapi":"3.1.0","info":{"title":"OWASP API Top 10 2023 Vulnerable API","description":"A vulnerable API for automated testing of OWASP API Top 10 2023 issues.","contact":{"name":" ᗧ···ᗣ···ᗣ···ᗣ···ᗣ·· "},"version":"1.0.0"},"paths":{"/":{"get":{"summary":"Read Root","operationId":"read_root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/BOLA/profile/{user_id}":{"get":{"summary":"Get User Profile","description":"Vulnerable: Can access any user's profile","operationId":"get_user_profile_api_BOLA_profile__user_id__get","parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[]}},"/api/BOLA/{user_id}/invoice/{invoice_id}":{"get":{"summary":"Get User Invoice","description":"Vulnerable: No check if invoice belongs to user","operationId":"get_user_invoice_api_BOLA__user_id__invoice__invoice_id__get","parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}},{"name":"invoice_id","in":"path","required":true,"schema":{"type":"integer","title":"Invoice Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[]}},"/api/BOLA/purchase":{"get":{"summary":"Get Purchase","description":"Vulnerable: Any user can access any purchase","operationId":"get_purchase_api_BOLA_purchase_get","parameters":[{"name":"product","in":"query","required":true,"schema":{"type":"integer","title":"Product"}},{"name":"user","in":"query","required":true,"schema":{"type":"integer","title":"User"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[]}},"/api/BOLA/ticket":{"get":{"summary":"Get Ticket","description":"Vulnerable: Direct object reference without authorization","operationId":"get_ticket_api_BOLA_ticket_get","parameters":[{"name":"id","in":"query","required":true,"schema":{"type":"integer","title":"Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[]}},"/api/BKEN_AUTH/login":{"post":{"summary":"Login","description":"Vulnerable: Weak authentication, no rate limiting","operationId":"login_api_BKEN_AUTH_login_post","parameters":[{"name":"username","in":"query","required":true,"schema":{"type":"string","title":"Username"}},{"name":"password","in":"query","required":true,"schema":{"type":"string","title":"Password"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[]}},"/api/BKEN_AUTH/reset-password":{"post":{"summary":"Reset Password","description":"Vulnerable: No verification, accepts any email","operationId":"reset_password_api_BKEN_AUTH_reset_password_post","parameters":[{"name":"email","in":"query","required":true,"schema":{"type":"string","title":"Email"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[]}},"/api/BKEN_AUTH/verify-token":{"post":{"summary":"Verify Token","description":"Vulnerable: Accepts weak tokens","operationId":"verify_token_api_BKEN_AUTH_verify_token_post","parameters":[{"name":"token","in":"query","required":true,"schema":{"type":"string","title":"Token"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[]}},"/api/BKEN_AUTH/session/{session_id}":{"get":{"summary":"Get Session","description":"Vulnerable: Predictable session IDs","operationId":"get_session_api_BKEN_AUTH_session__session_id__get","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[]}},"/api/BOPLA/user/{user_id}":{"get":{"summary":"Get User Details","description":"Vulnerable: Returns sensitive data like SSN","operationId":"get_user_details_api_BOPLA_user__user_id__get","parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[]},"patch":{"summary":"Update User","description":"Vulnerable: Allows updating any property including role","operationId":"update_user_api_BOPLA_user__user_id__patch","parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Data"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[]}},"/api/BOPLA/invoice/{invoice_id}/details":{"get":{"summary":"Get Invoice Details","description":"Vulnerable: Returns internal fields","operationId":"get_invoice_details_api_BOPLA_invoice__invoice_id__details_get","parameters":[{"name":"invoice_id","in":"path","required":true,"schema":{"type":"integer","title":"Invoice Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[]}},"/api/URC/search":{"get":{"summary":"Search Products","description":"Vulnerable: No limits on query length or results","operationId":"search_products_api_URC_search_get","parameters":[{"name":"query","in":"query","required":true,"schema":{"type":"string","title":"Query"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/URC/upload":{"post":{"summary":"Upload File","description":"Vulnerable: No file size limits","operationId":"upload_file_api_URC_upload_post","parameters":[{"name":"file_size","in":"query","required":true,"schema":{"type":"integer","title":"File Size"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/URC/export/{format}":{"get":{"summary":"Export Data","description":"Vulnerable: No limits on export size","operationId":"export_data_api_URC_export__format__get","parameters":[{"name":"format","in":"path","required":true,"schema":{"type":"string","title":"Format"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/BFLA/admin/users":{"get":{"summary":"Get All Users","description":"Vulnerable: No admin check","operationId":"get_all_users_api_BFLA_admin_users_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/BFLA/admin/user/{user_id}":{"delete":{"summary":"Delete User","description":"Vulnerable: Anyone can delete users","operationId":"delete_user_api_BFLA_admin_user__user_id__delete","parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/BFLA/admin/promote/{user_id}":{"post":{"summary":"Promote User","description":"Vulnerable: No authorization check for promotion","operationId":"promote_user_api_BFLA_admin_promote__user_id__post","parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/BFLA/internal/config":{"get":{"summary":"Get Internal Config","description":"Vulnerable: Internal endpoint accessible to all","operationId":"get_internal_config_api_BFLA_internal_config_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/UABF/purchase/{product_id}":{"post":{"summary":"Purchase Product","description":"Vulnerable: No rate limiting or captcha on purchases","operationId":"purchase_product_api_UABF_purchase__product_id__post","parameters":[{"name":"product_id","in":"path","required":true,"schema":{"type":"integer","title":"Product Id"}},{"name":"user_id","in":"query","required":true,"schema":{"type":"integer","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/UABF/transfer":{"post":{"summary":"Transfer Funds","description":"Vulnerable: No rate limiting on transfers","operationId":"transfer_funds_api_UABF_transfer_post","parameters":[{"name":"from_user","in":"query","required":true,"schema":{"type":"integer","title":"From User"}},{"name":"to_user","in":"query","required":true,"schema":{"type":"integer","title":"To User"}},{"name":"amount","in":"query","required":true,"schema":{"type":"number","title":"Amount"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/UABF/review/{product_id}":{"post":{"summary":"Submit Review","description":"Vulnerable: No rate limiting on reviews","operationId":"submit_review_api_UABF_review__product_id__post","parameters":[{"name":"product_id","in":"path","required":true,"schema":{"type":"integer","title":"Product Id"}},{"name":"user_id","in":"query","required":true,"schema":{"type":"integer","title":"User Id"}},{"name":"rating","in":"query","required":true,"schema":{"type":"integer","title":"Rating"}},{"name":"comment","in":"query","required":true,"schema":{"type":"string","title":"Comment"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/SSRF/fetch":{"get":{"summary":"Fetch Url","description":"Vulnerable: No URL validation","operationId":"fetch_url_api_SSRF_fetch_get","parameters":[{"name":"url","in":"query","required":true,"schema":{"type":"string","title":"Url"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/SSRF/webhook":{"post":{"summary":"Webhook Callback","description":"Vulnerable: Accepts any callback URL","operationId":"webhook_callback_api_SSRF_webhook_post","parameters":[{"name":"callback_url","in":"query","required":true,"schema":{"type":"string","title":"Callback Url"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Data"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/SSRF/proxy/{path}":{"get":{"summary":"Proxy Request","description":"Vulnerable: Acts as an open proxy","operationId":"proxy_request_api_SSRF_proxy__path__get","parameters":[{"name":"path","in":"path","required":true,"schema":{"type":"string","title":"Path"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/SEC_MISC/debug":{"get":{"summary":"Debug Info","description":"Vulnerable: Exposes debug information","operationId":"debug_info_api_SEC_MISC_debug_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/SEC_MISC/config":{"get":{"summary":"Get Config","description":"Vulnerable: Exposes configuration","operationId":"get_config_api_SEC_MISC_config_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/SEC_MISC/logs":{"get":{"summary":"Get Logs","description":"Vulnerable: Exposes application logs","operationId":"get_logs_api_SEC_MISC_logs_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/SEC_MISC/headers":{"get":{"summary":"Test Headers","description":"Vulnerable: No security headers","operationId":"test_headers_api_SEC_MISC_headers_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/IIM/v1/users":{"get":{"summary":"Get Users V1","description":"Vulnerable: Old API version still accessible","operationId":"get_users_v1_api_IIM_v1_users_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/IIM/v2/users":{"get":{"summary":"Get Users V2","description":"Current API version","operationId":"get_users_v2_api_IIM_v2_users_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/IIM/beta/experimental":{"get":{"summary":"Experimental Endpoint","description":"Vulnerable: Beta endpoint in production","operationId":"experimental_endpoint_api_IIM_beta_experimental_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/IIM/deprecated/auth":{"get":{"summary":"Deprecated Auth","description":"Vulnerable: Deprecated but still functional","operationId":"deprecated_auth_api_IIM_deprecated_auth_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/UCAPI/process-data":{"post":{"summary":"Process External Data","description":"Vulnerable: Processes external API data without validation","operationId":"process_external_data_api_UCAPI_process_data_post","parameters":[{"name":"external_api_url","in":"query","required":true,"schema":{"type":"string","title":"External Api Url"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/UCAPI/integrate/{service}":{"post":{"summary":"Integrate Service","description":"Vulnerable: Trusts external service responses","operationId":"integrate_service_api_UCAPI_integrate__service__post","parameters":[{"name":"service","in":"path","required":true,"schema":{"type":"string","title":"Service"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Api Response"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/UCAPI/aggregate/{source}":{"get":{"summary":"Aggregate Data","description":"Vulnerable: No timeout limits on external calls","operationId":"aggregate_data_api_UCAPI_aggregate__source__get","parameters":[{"name":"source","in":"path","required":true,"schema":{"type":"string","title":"Source"}},{"name":"timeout","in":"query","required":false,"schema":{"type":"integer","default":30,"title":"Timeout"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"},"Error":{"type":"object","properties":{"error":{"type":"string"}}}},"securitySchemes":{"bearerAuth":{"type":"http","scheme":"bearer","bearerFormat":"JWT"}}},"servers":[{"url":"http://localhost:8000","description":"OWASP Testing server"}],"security":[{"bearerAuth":[]}]}